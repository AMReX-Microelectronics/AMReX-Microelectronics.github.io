<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Building WarpX to use RZ geometry &mdash; MicroEleX 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            MicroEleX
          </a>
              <div class="version">
                1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">INSTALLATION</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install/users.html">Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/cmake.html">Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/hpc.html">HPC</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">USAGE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../usage/how_to_run.html">Run WarpX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/domain_decomposition.html">Domain Decomposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/parameters.html">Input Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/python.html">Python (PICMI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/examples.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">DATA ANALYSIS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../dataanalysis/formats.html">Output formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dataanalysis/yt.html">yt-project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dataanalysis/openpmdviewer.html">openPMD-viewer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dataanalysis/openpmdapi.html">openPMD-api</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dataanalysis/paraview.html">3D Visualization: ParaView</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dataanalysis/visit.html">3D Visualization: VisIt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dataanalysis/visualpic.html">VisualPIC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dataanalysis/picviewer.html">PICViewer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dataanalysis/reduced_diags.html">Reduced diagnostics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dataanalysis/workflows.html">Workflows</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">EPILOGUE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../acknowledgements.html">Funding and Acknowledgements</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MicroEleX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Building WarpX to use RZ geometry</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/developers/gnumake/rzgeometry.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="building-warpx-to-use-rz-geometry">
<h1>Building WarpX to use RZ geometry<a class="headerlink" href="#building-warpx-to-use-rz-geometry" title="Link to this heading"></a></h1>
<p>WarpX can be built to run with RZ geometry. Both an FDTD solver (the default)
and a PSATD solver are available. Both solvers allow multiple azimuthal modes.</p>
<p>To select RZ geometry, set the flag USE_RZ = TRUE when compiling:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">make</span><span class="w"> </span><span class="o">-</span><span class="n">j</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="n">USE_RZ</span><span class="o">=</span><span class="n">TRUE</span>
</pre></div>
</div>
<p>Note that this sets DIM=2, which is required with USE_RZ=TRUE.
The executable produced will have “RZ” as a suffix.</p>
<section id="rz-geometry-with-spectral-solver">
<h2>RZ geometry with spectral solver<a class="headerlink" href="#rz-geometry-with-spectral-solver" title="Link to this heading"></a></h2>
<p>Additional steps are needed to build the spectral solver. Some of the steps
are the same as is done for the Cartesian spectral solver, setting up the FFTW
package and setting <code class="docutils literal notranslate"><span class="pre">USE_PSATD=TRUE</span></code>.</p>
<blockquote>
<div><ul>
<li><p>Install (or load) an MPI-enabled version of FFTW.
For instance, for Debian, this can be done with</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">apt</span><span class="o">-</span><span class="n">get</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">libfftw3</span><span class="o">-</span><span class="n">dev</span><span class="w"> </span><span class="n">libfftw3</span><span class="o">-</span><span class="n">mpi</span><span class="o">-</span><span class="n">dev</span>
</pre></div>
</div>
</li>
<li><p>Set the environment variable <code class="docutils literal notranslate"><span class="pre">FFTW_HOME</span></code> to the path for FFTW.
For instance, for Debian, this is done with</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">export</span><span class="w"> </span><span class="n">FFTW_HOME</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span>
</pre></div>
</div>
</li>
<li><p>Download and build the blaspp and lapackpp packages. These can be obtained from GitHub.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">git</span><span class="w"> </span><span class="n">clone</span><span class="w"> </span><span class="n">https</span><span class="o">:</span><span class="c1">//github.com/icl-utk-edu/blaspp.git</span>
<span class="n">git</span><span class="w"> </span><span class="n">clone</span><span class="w"> </span><span class="n">https</span><span class="o">:</span><span class="c1">//github.com/icl-utk-edu/lapackpp.git</span>
</pre></div>
</div>
<p>The two packages can be built in multiple ways. A recommended method is to follow the cmake instructions
provided in the INSTALL.md that comes with the packages. They can also be installed using spack.</p>
</li>
<li><p>Set the environment variables BLASPP_HOME and LAPACKPP_HOME to the locations where
the packages libraries were installed. For example, using bash:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">export</span><span class="w"> </span><span class="n">BLASPP_HOME</span><span class="o">=/</span><span class="n">location</span><span class="o">/</span><span class="n">of</span><span class="o">/</span><span class="n">installation</span><span class="o">/</span><span class="n">blaspp</span>
<span class="k">export</span><span class="w"> </span><span class="n">LAPACKPP_HOME</span><span class="o">=/</span><span class="n">location</span><span class="o">/</span><span class="n">of</span><span class="o">/</span><span class="n">installation</span><span class="o">/</span><span class="n">lapackpp</span>
</pre></div>
</div>
</li>
<li><p>In some case, the blas and lapack libraries need to be specified.
If needed, this can be done by setting the BLAS_LIB and LAPACK_LIB
environment variables appropriately. For example, using bash:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">export</span><span class="w"> </span><span class="n">BLAS_LIB</span><span class="o">=-</span><span class="n">lblas</span>
</pre></div>
</div>
</li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">USE_PSATD=TRUE</span></code> when compiling:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">make</span><span class="w"> </span><span class="o">-</span><span class="n">j</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="n">USE_RZ</span><span class="o">=</span><span class="n">TRUE</span><span class="w"> </span><span class="n">USE_PSATD</span><span class="o">=</span><span class="n">TRUE</span>
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017-2024, MicroEleX collaboration.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>