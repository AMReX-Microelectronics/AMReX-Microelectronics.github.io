<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Python interface &mdash; MicroEleX 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=87e54e7c" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=f2a433a1"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/design-tabs.js?v=36754332"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            MicroEleX
          </a>
              <div class="version">
                1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">INSTALLATION</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install/artemis.html">ARTEMIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/eleqtroneX.html">ELEQTRONeX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/ferrox.html">FerroX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/magnex.html">MagneX</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">USAGE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../usage/run_artemis.html">Run ARTEMIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/run_eleqtronex.html">Run ELEQTRONeX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/run_ferrox.html">Run FerroX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/run_magnex.html">Run MagneX</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">DATA ANALYSIS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dataanalysis/formats.html">Output Formats and Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dataanalysis/yt.html">yt-project</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">EPILOGUE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../acknowledgements.html">Funding and Acknowledgements</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MicroEleX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Python interface</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/developers/python.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="python-interface">
<span id="development-python"></span><h1>Python interface<a class="headerlink" href="#python-interface" title="Link to this heading"></a></h1>
<p>The Python interface provides low and high level access to much of the data in WarpX.
With the low level access, a user has direct access to the underlying memory contained
in the MultiFabs and in the particle arrays.
The high level provides a more user friendly interface.</p>
<section id="high-level-interface">
<h2>High level interface<a class="headerlink" href="#high-level-interface" title="Link to this heading"></a></h2>
<p>There are two python modules that provide convenient access to the fields and the particles.</p>
<section id="fields">
<h3>Fields<a class="headerlink" href="#fields" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">fields</span></code> module provides wrapper around most of the MultiFabs that are defined in the WarpX class.
For a list of all of the available wrappers, see the file <code class="docutils literal notranslate"><span class="pre">Python/pywarpx/fields.py</span></code>.
For each MultiFab, there is a function that will return a wrapper around the data.
For instance, the function <code class="docutils literal notranslate"><span class="pre">ExWrapper</span></code> returns a wrapper around the <code class="docutils literal notranslate"><span class="pre">x</span></code> component of the MultiFab vector <code class="docutils literal notranslate"><span class="pre">Efield_aux</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pywarpx</span> <span class="kn">import</span> <span class="n">fields</span>
<span class="n">Ex</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">ExWrapper</span><span class="p">()</span>
</pre></div>
</div>
<p>By default, this wraps the MultiFab for level 0. The <code class="docutils literal notranslate"><span class="pre">level</span></code> argument can be specified for other levels.
By default, the wrapper only includes the valid cells. To include the ghost cells, set the argument <code class="docutils literal notranslate"><span class="pre">include_ghosts=True</span></code>.</p>
<p>The wrapper provides access to the data via global indexing.
Using standard array indexing (with exceptions) with square brackets, the data can be accessed using indices that are relative to the full domain (across the MultiFab and across processors).
With multiple processors, the result is broadcast to all processors.
This example will return the <code class="docutils literal notranslate"><span class="pre">Bz</span></code> field at all points along <code class="docutils literal notranslate"><span class="pre">x</span></code> at the specified <code class="docutils literal notranslate"><span class="pre">y</span></code> and <code class="docutils literal notranslate"><span class="pre">z</span></code> indices.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pywarpx</span> <span class="kn">import</span> <span class="n">fields</span>
<span class="n">Bz</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">BzWrapper</span><span class="p">()</span>
<span class="n">Bz_along_x</span> <span class="o">=</span> <span class="n">Bz</span><span class="p">[:,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
<p>The same global indexing can be done to set values. This example will set the values over a range in <code class="docutils literal notranslate"><span class="pre">y</span></code> and <code class="docutils literal notranslate"><span class="pre">z</span></code> at the
specified <code class="docutils literal notranslate"><span class="pre">x</span></code>. The data will be scattered appropriately to the underlying FABs.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pywarpx</span> <span class="kn">import</span> <span class="n">fields</span>
<span class="n">Jy</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">JyFPWrapper</span><span class="p">()</span>
<span class="n">Jy</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span><span class="mi">8</span><span class="p">:</span><span class="mi">30</span><span class="p">]</span> <span class="o">=</span> <span class="mf">7.</span>
</pre></div>
</div>
<p>The code does error checking to ensure that the specified indices are within the bounds of the global domain.
Note that negative indices are handled differently than with numpy arrays because of the possibility of having ghost cells.
With ghost cells, the lower ghost cells are accessed using negative indices (since <code class="docutils literal notranslate"><span class="pre">0</span></code> is the index of the lower bound of the
valid cells). Without ghost cells, a negative index will always raise an out of bounds error since there are no ghost cells.</p>
<p>Under the covers, the wrapper object has a list of numpy arrays that have pointers to the underlying data, one array for each FAB.
When data is being fetched, it loops over that list to gather the data.
The result is then gathered among all processors.
Note that the result is not writeable, in the sense that changing it won’t change the underlying data since it is a copy.
When the data is set, using the global indexing, a similar process is done where the processors loop over their FABs and set the data at the appropriate indices.</p>
<p>The wrappers are always up to date since whenever an access is done (either a get or a set), the list of numpy arrays for the FABs is regenerated.
In this case, efficiency is sacrificed for consistency.</p>
<p>If it is needed, the list of numpy arrays associated with the FABs can be obtained using the wrapper method <code class="docutils literal notranslate"><span class="pre">_getfields</span></code>.
Additionally, there are the methods <code class="docutils literal notranslate"><span class="pre">_getlovects</span></code> and <code class="docutils literal notranslate"><span class="pre">_gethivects</span></code> that get the list of the bounds of each of the arrays.</p>
</section>
<section id="particles">
<h3>Particles<a class="headerlink" href="#particles" title="Link to this heading"></a></h3>
<p>This is still in development.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017-2024, MicroEleX collaboration.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>